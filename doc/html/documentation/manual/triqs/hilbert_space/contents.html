
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>[triqs/hilbert_space] Many-body states and Hilbert spaces &#8212; TRIQS Docs</title>
    <link rel="stylesheet" href="../../../../_static/triqs2.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../../../" src="../../../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../../_static/language_data.js"></script>
    <script type="text/javascript" src="../../../../_static/triqs2.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=default"></script>
    <link rel="shortcut icon" href="../../../../_static/favicon.ico"/>
    <link rel="author" title="About these documents" href="../../../../about.html" />
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
<link rel="stylesheet" href="https://use.typekit.net/hsv6sot.css" />
<script type="text/javascript">
  try {
    Typekit.load();
  } catch (e) {}
</script>

  </head>
<body>
  
  <header class="header">
    <nav class="header-content">
      <div class="row header-row">
        <div class="col-xs-2 logo-col">
          <div class="row start-xs">
            <div class="nav-item">
              <a class="nav-link" href="/"
                ><span class="nav-logo">TRIQS</span></a
              >
            </div>
          </div>
        </div>
        <div class="col-xs-6">
          <div class="row">
            <div class="nav-item">
              <a class="nav-link" href="/documentation.html">Docs</a>
            </div>
            <div class="nav-item">
              <a class="nav-link" href="/tutorials.html">Tutorials</a>
            </div>
            <div class="nav-item">
              <a class="nav-link" href="/applications.html">Applications</a>
            </div>
            <div class="nav-item">
              <a class="nav-link" href="/community.html">Community</a>
            </div>
          </div>
        </div>
        <div class="col-xs-4">
          <div class="row end-xs">
            <div class="nav-item">
              <a class="nav-link" href="/about.html">About</a>
            </div>
            <div class="nav-item">
              <a
                class="nav-link"
                target="_blank"
                rel="noopener noreferrer"
                href="https://github.com/TRIQS/triqs"
                >Github</a
              >
            </div>
          </div>
        </div>
      </div>
    </nav>
  </header>
    

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="triqs-hilbert-space-many-body-states-and-hilbert-spaces">
<span id="hilbert-space-contents"></span><span id="index-0"></span><h1><strong>[triqs/hilbert_space]</strong> Many-body states and Hilbert spaces<a class="headerlink" href="#triqs-hilbert-space-many-body-states-and-hilbert-spaces" title="Permalink to this headline">¶</a></h1>
<p><cite>hilbert_space</cite> toolbox provides the user with a small set of abstractions, useful
for doing calculations in the Hamiltonian picture for finite fermionic systems.
Among these abstarctions are Hilbert spaces, their subspaces, states and operators acting on them.
There is also an efficient implementation of the automatic partitioning algorithm
that allows to split a Hilbert space into a number of subspaces, each invariant
under action of a given operator.</p>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../cpp_api/triqs/hilbert_space/fundamental_operator_set.html">[fundamental_operator_set] Fundamental operator set</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../cpp_api/triqs/hilbert_space/fundamental_operator_set.html#member-types">Member types</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../cpp_api/triqs/hilbert_space/fundamental_operator_set.html#member-functions">Member functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../cpp_api/triqs/hilbert_space/fundamental_operator_set.html#non-member-functions">Non Member functions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../cpp_api/triqs/hilbert_space/hilbert_space.html">[hilbert_space] Full Hilbert space</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../cpp_api/triqs/hilbert_space/hilbert_space.html#member-functions">Member functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../cpp_api/triqs/hilbert_space/hilbert_space.html#non-member-functions">Non Member functions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../cpp_api/triqs/hilbert_space/sub_hilbert_space.html">[sub_hilbert_space] Hilbert subspace</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../cpp_api/triqs/hilbert_space/sub_hilbert_space.html#member-functions">Member functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../cpp_api/triqs/hilbert_space/sub_hilbert_space.html#non-member-functions">Non Member functions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../cpp_api/triqs/hilbert_space/state.html">[state] Many-body state</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../cpp_api/triqs/hilbert_space/state.html#template-parameters">Template parameters</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../cpp_api/triqs/hilbert_space/imperative_operator.html">[imperative_operator] Imperative operator</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../cpp_api/triqs/hilbert_space/imperative_operator.html#template-parameters">Template parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../cpp_api/triqs/hilbert_space/imperative_operator.html#member-functions">Member functions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../cpp_api/triqs/hilbert_space/space_partition.html">[autopartition] Automatic partitioning algorithm</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../cpp_api/triqs/hilbert_space/space_partition.html#template-parameters">Template parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../cpp_api/triqs/hilbert_space/space_partition.html#member-types">Member types</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../cpp_api/triqs/hilbert_space/space_partition.html#member-functions">Member functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../cpp_api/triqs/hilbert_space/space_partition.html#non-member-functions">Non Member functions</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="example-of-use">
<h2>Example of use<a class="headerlink" href="#example-of-use" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>#include &lt;bitset&gt;

#include &lt;triqs/operators/many_body_operator.hpp&gt;

#include &lt;triqs/hilbert_space/fundamental_operator_set.hpp&gt;
#include &lt;triqs/hilbert_space/hilbert_space.hpp&gt;
#include &lt;triqs/hilbert_space/state.hpp&gt;
#include &lt;triqs/hilbert_space/imperative_operator.hpp&gt;
#include &lt;triqs/hilbert_space/space_partition.hpp&gt;

using namespace triqs::operators;
using namespace triqs::hilbert_space;
using namespace std;

int main() {

  // Model system: half-filled Hubbard dimer

  // Parameters
  double U  = 2.0;   // Coulomb repulsion
  double mu = U / 2; // Chemical potential
  double t  = 0.2;   // Hopping amplitude

  // Set of fundamental operators
  // Every fundamental operator carries two indices, one atom index and one spin projection
  fundamental_operator_set fops;
  fops.insert(1, &quot;up&quot;);
  fops.insert(1, &quot;down&quot;);
  fops.insert(2, &quot;up&quot;);
  fops.insert(2, &quot;down&quot;);

  // Full Hilbert space of the dimer
  hilbert_space hs(fops);

  // Hamiltonian
  auto H = U * n(1, &quot;up&quot;) * n(1, &quot;down&quot;) + U * n(2, &quot;up&quot;) * n(2, &quot;down&quot;);
  H += -mu * (n(1, &quot;up&quot;) + n(1, &quot;down&quot;) + n(2, &quot;up&quot;) + n(2, &quot;down&quot;));

  for (auto s : {&quot;up&quot;, &quot;down&quot;}) H += -t * (c_dag(1, s) * c(2, s) + c_dag(2, s) * c(1, s));

  // Imperative form of the Hamiltonian acting on the full Hilbert space
  using full_hs_operator_t = imperative_operator&lt;hilbert_space, double, false&gt;;
  full_hs_operator_t hamiltonian(H, fops);

  // Many-body state in the full Hilbert space
  using state_t = state&lt;hilbert_space, double, true /* using sparse storage */&gt;;
  state_t st(hs);

  // Partition the Hilbert space
  space_partition&lt;state_t, full_hs_operator_t&gt; partition(st, hamiltonian);

  // Preallocate a container for the invariant subspaces of H
  vector&lt;sub_hilbert_space&gt; inv_subspaces;
  for (int n = 0; n &lt; partition.n_subspaces(); ++n) inv_subspaces.emplace_back(n);

  // Fill the subspaces with Fock spaces
  foreach (partition, [&amp;](int s, int spn) { inv_subspaces[spn].add_fock_state(hs.get_fock_state(s)); })
    ;

  // Observables: N_up and N_dn
  auto N_up = n(1, &quot;up&quot;) + n(2, &quot;up&quot;), N_down = n(1, &quot;down&quot;) + n(2, &quot;down&quot;);

  // Subspace connections generated by the observables
  auto N_up_conn   = partition.find_mappings(full_hs_operator_t(N_up, fops));
  auto N_down_conn = partition.find_mappings(full_hs_operator_t(N_down, fops));

  // Imperative versions of N_up and N_down acting between subspaces
  using sub_hs_operator_t = imperative_operator&lt;sub_hilbert_space, double, true&gt;;

  vector&lt;int&gt; N_up_hilbert_map(inv_subspaces.size(), -1);
  for (auto const &amp;conn : N_up_conn) N_up_hilbert_map[conn.first] = conn.second;
  sub_hs_operator_t N_up_op(N_up, fops, N_up_hilbert_map, &amp;inv_subspaces);

  vector&lt;int&gt; N_down_hilbert_map(inv_subspaces.size(), -1);
  for (auto const &amp;conn : N_down_conn) N_down_hilbert_map[conn.first] = conn.second;
  sub_hs_operator_t N_down_op(N_down, fops, N_down_hilbert_map, &amp;inv_subspaces);

  // Calculate and print expectation values of N_up and N_down
  for (int spn = 0; spn &lt; inv_subspaces.size(); ++spn) {
    // Iterate over invariant subspaces
    auto const &amp;subspace = inv_subspaces[spn];
    cout &lt;&lt; &quot;Invariant subspace &quot; &lt;&lt; spn &lt;&lt; endl;
    cout &lt;&lt; &quot;====================&quot; &lt;&lt; endl;
    cout &lt;&lt; &quot;State    N_up   N_dn&quot; &lt;&lt; endl;
    cout &lt;&lt; &quot;====================&quot; &lt;&lt; endl;

    // Iterate over basis Fock states in the selected subspace
    for (int i = 0; i &lt; subspace.size(); ++i) {

      // Many-body state defined on the subspace
      state&lt;sub_hilbert_space, double, false&gt; ket(subspace);
      ket(i) = 1;

      cout &lt;&lt; &quot;|&quot; &lt;&lt; bitset&lt;4&gt;(subspace.get_fock_state(i)) &lt;&lt; &quot;&gt;   &quot;;
      cout &lt;&lt; ((N_up_hilbert_map[spn] != -1) ? dot_product(ket, N_up_op(ket)) : 0) &lt;&lt; &quot;      &quot;;
      cout &lt;&lt; ((N_down_hilbert_map[spn] != -1) ? dot_product(ket, N_down_op(ket)) : 0) &lt;&lt; endl;
    }
  }

  return 0;
}
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><div class="sidebar">
  <div class="container-fluid sidebar-container">
      <div class="row sidebar-row">
        
          <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../gettingstarted.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../applications.html">Applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../capiref.html">C++ API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../pythonapiref.html">Python API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../community.html">Community</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../about.html">About</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../faqs.html">FAQS</a></li>
</ul>

        
      </div>
      <div class="row sidebar-row search-row">
        <div
          class="sidebar-section"
          id="searchbox"
          style="display: none"
          role="search"
        >
          <div class="sidebar-header">
            <a class="sidebar-header-link">Quick search</a>
          </div>
        </div>
        <div class="searchformwrapper">
          <form class="search" action="../../../../search.html" method="get">
            <input type="text" name="q" aria-labelledby="searchlabel" />
            <input type="submit" value="Go" />
          </form>
        </div>
        <script type="text/javascript">
          $("#searchbox").show(0);
        </script>
      </div>
    </div>
  </div>
</div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
  <footer>
    <div class="container-fluid">
      <div class="row footer">
        <div class="col-xs-12 center-xs middle-xs">
          <div class="outro">
            <p class="footer-description">
              TRIQS (Toolbox for Research on Interacting Quantum Systems) is a
              scientific project providing a set of C++ and Python libraries to
              develop new tools for the study of interacting quantum systems
              based at the Center for Computational Quantum Physics at the
              Flatiron Institute.
            </p>
          </div>
          <ul class="footer-links">
            <li class="footer-link">
              <a exact="true" href="/about.html">About</a>
            </li>
            <li class="footer-link">
              <a
                target="_blank"
                rel="noopener noreferrer"
                href="https://simonsfoundation.org"
                >Simons Foundation</a
              >
            </li>
            <li class="footer-link">
              <a
                target="_blank"
                rel="noopener noreferrer"
                href="https://flatironinstitute.org"
                >Flatiron Institute</a
              >
            </li>
            <li class="footer-link"><a exact="true" href="/">Github</a></li>
            <li class="footer-link">
              <a exact="true" href="/contact">Contact</a>
            </li>
          </ul>
          <p class="updated">Updated on November 20, 2019 (2:20pm)</p>
        </div>
      </div>
    </div>
  </footer>
  
  </body>
</html>