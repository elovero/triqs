
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Local Green’s functions &#8212; TRIQS Docs</title>
    <link rel="stylesheet" href="../../_static/triqs2.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/language_data.js"></script>
    <script type="text/javascript" src="../../_static/triqs2.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=default"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
<link rel="stylesheet" href="https://use.typekit.net/hsv6sot.css" />
<script type="text/javascript">
  try {
    Typekit.load();
  } catch (e) {}
</script>

  </head>
<body>
  
  <header class="header">
    <nav class="header-content">
      <div class="row header-row">
        <div class="col-xs-2 logo-col">
          <div class="row start-xs">
            <div class="nav-item">
              <a class="nav-link" href="/"
                ><span class="nav-logo">TRIQS</span></a
              >
            </div>
          </div>
        </div>
        <div class="col-xs-6">
          <div class="row">
            <div class="nav-item">
              <a class="nav-link" href="/documentation.html">Docs</a>
            </div>
            <div class="nav-item">
              <a class="nav-link" href="/tutorials.html">Tutorials</a>
            </div>
            <div class="nav-item">
              <a class="nav-link" href="/applications.html">Applications</a>
            </div>
            <div class="nav-item">
              <a class="nav-link" href="/community.html">Community</a>
            </div>
          </div>
        </div>
        <div class="col-xs-4">
          <div class="row end-xs">
            <div class="nav-item">
              <a class="nav-link" href="/about.html">About</a>
            </div>
            <div class="nav-item">
              <a
                class="nav-link"
                target="_blank"
                rel="noopener noreferrer"
                href="https://github.com/TRIQS/triqs"
                >Github</a
              >
            </div>
          </div>
        </div>
      </div>
    </nav>
  </header>
    

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="local-green-s-functions">
<span id="index-0"></span><h1>Local Green’s functions<a class="headerlink" href="#local-green-s-functions" title="Permalink to this headline">¶</a></h1>
<p>In this first part, we present a couple of examples in the form of a tutorial.
The full reference is presented in the next sections.</p>
<div class="section" id="a-simple-example">
<h2>A simple example<a class="headerlink" href="#a-simple-example" title="Permalink to this headline">¶</a></h2>
<p>As a first example, we construct and plot the following Matsubara Green’s function:</p>
<div class="math notranslate nohighlight">
\[G_{11} (i \omega_n) = \frac{1}{i \omega_n + 0.5}\]</div>
<p>This is done with the code :</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import the Green&#39;s functions </span>
<span class="kn">from</span> <span class="nn">pytriqs.gf</span> <span class="kn">import</span> <span class="n">GfImFreq</span><span class="p">,</span> <span class="n">iOmega_n</span><span class="p">,</span> <span class="n">inverse</span>

<span class="c1"># Create the Matsubara-frequency Green&#39;s function and initialize it</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">GfImFreq</span><span class="p">(</span><span class="n">indices</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">beta</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="n">n_points</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;$G_\mathrm{imp}$&quot;</span><span class="p">)</span>
<span class="n">g</span> <span class="o">&lt;&lt;</span> <span class="n">inverse</span><span class="p">(</span> <span class="n">iOmega_n</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="p">)</span>

<span class="kn">from</span> <span class="nn">pytriqs.plot.mpl_interface</span> <span class="kn">import</span> <span class="n">oplot</span>
<span class="n">oplot</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="s1">&#39;-o&#39;</span><span class="p">,</span>  <span class="n">x_window</span>  <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../../userguide/gfs/example.py">Source code</a>)</p>
<p>In this very simple example, the Green’s function is just a 1x1 block. Let’s go through
the different steps of the example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import the Green&#39;s functions </span>
<span class="kn">from</span> <span class="nn">pytriqs.gf</span> <span class="k">import</span> <span class="n">GfImFreq</span><span class="p">,</span> <span class="n">iOmega_n</span><span class="p">,</span> <span class="n">inverse</span>
</pre></div>
</div>
<p>This imports all the necessary classes to manipulate Green’s functions. In this example it allows
to use <code class="docutils literal notranslate"><span class="pre">GfImFreq</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create the Matsubara-frequency Green&#39;s function and initialize it</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">GfImFreq</span><span class="p">(</span><span class="n">indices</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">beta</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="n">n_points</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;$G_\mathrm</span><span class="si">{imp}</span><span class="s2">$&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>This creates a <strong>block</strong> Green’s function which has just one index
(1). <code class="docutils literal notranslate"><span class="pre">beta</span></code> is the inverse temperature, <code class="docutils literal notranslate"><span class="pre">n_points</span></code> is the number of
Matsubara frequencies.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">&lt;&lt;</span> <span class="n">inverse</span><span class="p">(</span> <span class="n">iOmega_n</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="p">)</span>
</pre></div>
</div>
<p>This initializes the block with <span class="math notranslate nohighlight">\(1/(i \omega_n + 0.5)\)</span>.
Two points are worth noting here:</p>
<ul class="simple">
<li><p>The right hand side (RHS) of this statement is a <em>lazy</em> expression: its evaluation is delayed until
it is needed to fill the Green function.</p></li>
<li><p>The funny <em>&lt;&lt;</em> operator means “set from”. It fills the Green function with the evaluation of the expression
at the right.</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">oplot</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="s1">&#39;-o&#39;</span><span class="p">,</span>  <span class="n">x_window</span>  <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>

</pre></div>
</div>
<p>These lines plot the block Green’s function (both the real and imaginary parts) using
the matplotlib plotter. More details can be found in the section
<a class="reference internal" href="../../documentation/manual/triqs/plotting_protocols/plotting/plotting.html#plotting"><span class="std std-ref">Plotting TRIQS objects</span></a>.</p>
</div>
<div class="section" id="a-slightly-more-complicated-example">
<h2>A slightly more complicated example<a class="headerlink" href="#a-slightly-more-complicated-example" title="Permalink to this headline">¶</a></h2>
<p>Let’s turn to another example. This time we consider a problem of a d-impurity
level embedded in a flat conduction bath <span class="math notranslate nohighlight">\(\Delta\)</span> of s-electrons. We want to
construct the corresponding 2x2 Green’s function:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\hat{G}^\mathrm{s+d} (\omega_n) = \begin{pmatrix} \omega_n - \epsilon_d &amp; V \\ V &amp; \Delta^{-1} \end{pmatrix}^{-1}\end{split}\]</div>
<p>This is done with the code:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pytriqs.gf</span> <span class="kn">import</span> <span class="n">GfReFreq</span><span class="p">,</span> <span class="n">Omega</span><span class="p">,</span> <span class="n">Wilson</span><span class="p">,</span> <span class="n">inverse</span>
<span class="kn">import</span> <span class="nn">numpy</span>

<span class="n">eps_d</span><span class="p">,</span><span class="n">t</span>  <span class="o">=</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.2</span>

<span class="c1"># Create the real-frequency Green&#39;s function and initialize it</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">GfReFreq</span><span class="p">(</span><span class="n">indices</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;s&#39;</span><span class="p">,</span><span class="s1">&#39;d&#39;</span><span class="p">],</span> <span class="n">window</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">n_points</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;$G_\mathrm{s+d}$&quot;</span><span class="p">)</span>
<span class="n">g</span><span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">,</span><span class="s1">&#39;d&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Omega</span> <span class="o">-</span> <span class="n">eps_d</span>
<span class="n">g</span><span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">,</span><span class="s1">&#39;s&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span>
<span class="n">g</span><span class="p">[</span><span class="s1">&#39;s&#39;</span><span class="p">,</span><span class="s1">&#39;d&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span>
<span class="n">g</span><span class="p">[</span><span class="s1">&#39;s&#39;</span><span class="p">,</span><span class="s1">&#39;s&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">inverse</span><span class="p">(</span> <span class="n">Wilson</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">invert</span><span class="p">()</span>

<span class="c1"># Plot it with matplotlib. &#39;S&#39; means: spectral function ( -1/pi Imag (g) )</span>
<span class="kn">from</span> <span class="nn">pytriqs.plot.mpl_interface</span> <span class="kn">import</span> <span class="n">oplot</span><span class="p">,</span> <span class="n">plt</span>
<span class="n">oplot</span><span class="p">(</span> <span class="n">g</span><span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">,</span><span class="s1">&#39;d&#39;</span><span class="p">],</span> <span class="s1">&#39;-o&#39;</span><span class="p">,</span> <span class="n">RI</span> <span class="o">=</span> <span class="s1">&#39;S&#39;</span><span class="p">,</span> <span class="n">x_window</span>  <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.8</span><span class="p">,</span><span class="mf">1.8</span><span class="p">),</span> <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Impurity&quot;</span> <span class="p">)</span>
<span class="n">oplot</span><span class="p">(</span> <span class="n">g</span><span class="p">[</span><span class="s1">&#39;s&#39;</span><span class="p">,</span><span class="s1">&#39;s&#39;</span><span class="p">],</span> <span class="s1">&#39;-x&#39;</span><span class="p">,</span> <span class="n">RI</span> <span class="o">=</span> <span class="s1">&#39;S&#39;</span><span class="p">,</span> <span class="n">x_window</span>  <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.8</span><span class="p">,</span><span class="mf">1.8</span><span class="p">),</span> <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Bath&quot;</span> <span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../../userguide/gfs/impinbath.py">Source code</a>)</p>
<p>Again, the Green’s function is just one block, but this time it is a 2x2 block with
off-diagonal elements. Another difference is that we use real-frequency Green’s functions in
this example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create the real-frequency Green&#39;s function and initialize it</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">GfReFreq</span><span class="p">(</span><span class="n">indices</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;s&#39;</span><span class="p">,</span><span class="s1">&#39;d&#39;</span><span class="p">],</span> <span class="n">window</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">n_points</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;$G_\mathrm{s+d}$&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>In this constructor for the block Green’s function, we specify that there are two indices s and d.
Because it is a real-frequency Green’s function we need to define the mesh on which it is
computed. This is done with the <code class="docutils literal notranslate"><span class="pre">window</span></code> and <code class="docutils literal notranslate"><span class="pre">n_points</span></code> options.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">g</span><span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">,</span><span class="s1">&#39;d&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Omega</span> <span class="o">-</span> <span class="n">eps_d</span>
<span class="n">g</span><span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">,</span><span class="s1">&#39;s&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span>
<span class="n">g</span><span class="p">[</span><span class="s1">&#39;s&#39;</span><span class="p">,</span><span class="s1">&#39;d&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span>
<span class="n">g</span><span class="p">[</span><span class="s1">&#39;s&#39;</span><span class="p">,</span><span class="s1">&#39;s&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">inverse</span><span class="p">(</span> <span class="n">Wilson</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="p">)</span>
</pre></div>
</div>
<p>These lines initialize specific entries of the block Green’s function. Note how the elements are
accessed with <code class="docutils literal notranslate"><span class="pre">[index1,index2]</span></code>. These lines also show how to initialize a Green’s function
to a constant or to the inverse of a Flat bath (constant spectral function on an interval <span class="math notranslate nohighlight">\([-D,D]\)</span>, with
<span class="math notranslate nohighlight">\(D=1.0\)</span> in our example).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">g</span><span class="o">.</span><span class="n">invert</span><span class="p">()</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">invert()</span></code> inverts the entire block Green’s function (as a matrix).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot it with matplotlib. &#39;S&#39; means: spectral function ( -1/pi Imag (g) )</span>
<span class="kn">from</span> <span class="nn">pytriqs.plot.mpl_interface</span> <span class="k">import</span> <span class="n">oplot</span><span class="p">,</span> <span class="n">plt</span>
<span class="n">oplot</span><span class="p">(</span> <span class="n">g</span><span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">,</span><span class="s1">&#39;d&#39;</span><span class="p">],</span> <span class="s1">&#39;-o&#39;</span><span class="p">,</span> <span class="n">RI</span> <span class="o">=</span> <span class="s1">&#39;S&#39;</span><span class="p">,</span> <span class="n">x_window</span>  <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.8</span><span class="p">,</span><span class="mf">1.8</span><span class="p">),</span> <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Impurity&quot;</span> <span class="p">)</span>
<span class="n">oplot</span><span class="p">(</span> <span class="n">g</span><span class="p">[</span><span class="s1">&#39;s&#39;</span><span class="p">,</span><span class="s1">&#39;s&#39;</span><span class="p">],</span> <span class="s1">&#39;-x&#39;</span><span class="p">,</span> <span class="n">RI</span> <span class="o">=</span> <span class="s1">&#39;S&#39;</span><span class="p">,</span> <span class="n">x_window</span>  <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.8</span><span class="p">,</span><span class="mf">1.8</span><span class="p">),</span> <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Bath&quot;</span> <span class="p">)</span>
</pre></div>
</div>
<p>Here, we isolate some elements of the blocks Green’s function.  It is also the
first example of an operation on the block Green’s function, which is
multiplied by a scalar. The last lines of the script just plot these new
objects.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><div class="sidebar">
  <div class="container-fluid sidebar-container">
      <div class="row sidebar-row">
        
          <ul>
<li class="toctree-l1"><a class="reference internal" href="../../gettingstarted.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../applications.html">Applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../capiref.html">C++ API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../pythonapiref.html">Python API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../community.html">Community</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../about.html">About</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../faqs.html">FAQS</a></li>
</ul>

        
      </div>
      <div class="row sidebar-row search-row">
        <div
          class="sidebar-section"
          id="searchbox"
          style="display: none"
          role="search"
        >
          <div class="sidebar-header">
            <a class="sidebar-header-link">Quick search</a>
          </div>
        </div>
        <div class="searchformwrapper">
          <form class="search" action="../../search.html" method="get">
            <input type="text" name="q" aria-labelledby="searchlabel" />
            <input type="submit" value="Go" />
          </form>
        </div>
        <script type="text/javascript">
          $("#searchbox").show(0);
        </script>
      </div>
    </div>
  </div>
</div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
  <footer>
    <div class="container-fluid">
      <div class="row footer">
        <div class="col-xs-12 center-xs middle-xs">
          <div class="outro">
            <p class="footer-description">
              TRIQS (Toolbox for Research on Interacting Quantum Systems) is a
              scientific project providing a set of C++ and Python libraries to
              develop new tools for the study of interacting quantum systems
              based at the Center for Computational Quantum Physics at the
              Flatiron Institute.
            </p>
          </div>
          <ul class="footer-links">
            <li class="footer-link">
              <a exact="true" href="/about.html">About</a>
            </li>
            <li class="footer-link">
              <a
                target="_blank"
                rel="noopener noreferrer"
                href="https://simonsfoundation.org"
                >Simons Foundation</a
              >
            </li>
            <li class="footer-link">
              <a
                target="_blank"
                rel="noopener noreferrer"
                href="https://flatironinstitute.org"
                >Flatiron Institute</a
              >
            </li>
            <li class="footer-link"><a exact="true" href="/">Github</a></li>
            <li class="footer-link">
              <a exact="true" href="/contact">Contact</a>
            </li>
          </ul>
          <p class="updated">Updated on November 20, 2019 (2:20pm)</p>
        </div>
      </div>
    </div>
  </footer>
  
  </body>
</html>